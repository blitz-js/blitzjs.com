---
title: Environment Variables
sidebar_label: Environment Variables
---

Blitz comes with built-in support for environment variables, which allows
you to do the following:

- [Use `.env*` files to load environment variables](#loading-environment-variables)
- [Expose environment variables to the browser by prefixing with `BLITZ_PUBLIC_`](#exposing-environment-variables-to-the-browser)

## Loading Environment Variables {#loading-environment-variables}

Blitz has built-in support for loading environment variables from
`.env.local` into `process.env`.

An example `.env.local`:

```bash
DB_HOST=localhost
DB_USER=myuser
DB_PASS=mypassword
```

This loads `process.env.DB_HOST`, `process.env.DB_USER`, and
`process.env.DB_PASS` into the Node.js environment automatically allowing
you to use them on the server.

> **Note**: Blitz will automatically expand variables inside of your
> `.env*` files. This allows you to reference other secrets, like so:
>
> ```bash
> # .env
> HOSTNAME=localhost
> PORT=8080
> HOST=http://$HOSTNAME:$PORT
> ```
>
> If you are trying to use a variable with a `$` in the actual value, it
> needs to be escaped like so: `\$`.
>
> For example:
>
> ```bash
> # .env
> A=abc
> WRONG=pre$A # becomes "preabc"
> CORRECT=pre\$A # becomes "pre$A"
> ```

## Server- and Client-Side Access to Env Vars {#server-and-client-side-access-to-env-vars}

Blitz allows you to control where environment variables are accessible (client
and/or server) and when environment variables are set (build and/or run time).
You can mix and match these techniques depending on how each env var fits into
your build-and-deploy cycle, and to keep confidential information server-side.

### Option 1: `BLITZ_PUBLIC_` prefix {#option-1-blitz-public-prefix}

Set at build time; accessible to client and server via `process.env`.

Prefix the variable with `BLITZ_PUBLIC_` or `NEXT_PUBLIC_`. For example:

```bash
BLITZ_PUBLIC_ANALYTICS_ID=abcdefghijk
```

The value will be inlined into JavaScript sent to the browser because of
the `BLITZ_PUBLIC_` prefix.

Example use:

```jsx
// pages/index.js
import setupAnalyticsService from "../lib/my-analytics-service"

setupAnalyticsService(process.env.BLITZ_PUBLIC_ANALYTICS_ID)

function HomePage() {
  return <h1>Hello World</h1>
}

export default HomePage
```

### Option 2: Any environment variable (#option-2-any-environment-variable)

Set at run time; accessible to server only via `process.env` (not client).

By default, any environment variable in the runtime environment that's not
prefixed with `BLITZ_PUBLIC_` or `NEXT_PUBLIC` `is available to the server.
There is no Blitz config required - the entire environment is available.

Note that these env vars can be overridden or hidden by Option 3 below.

### Option 3: Define an env var in the Blitz `env` config {#option-3-define-an-env-var-in-the-blitz-env-config}

Set at build time; accessible to client and server via `process.env`.

Any keys defined in the `env` section of your Blitz config will be inlined
into JavaScript sent to the browser. Note that you determine what key will
be used - it can but doesn't have to match the inbound `process.env` key:

```js
// blitz.config.js
module.exports = {
  env: {
    STRIPE_KEY: process.env.STRIPE_KEY,
    SENTRY_DSN: process.env.SENTRY_DSN,
    RENAMED_ANALYTICS_ID: process.env.ANALYTICS_ID,
  },
}
```

Example use:

```jsx
// pages/index.js
import setupAnalyticsService from "../lib/my-analytics-service"

// RENAMED_ANALYTICS_ID can be used here as it's been defined in `env` in `blitz.config.js`
setupAnalyticsService(process.env.RENAMED_ANALYTICS_ID)

function HomePage() {
  return <h1>Hello World</h1>
}

export default HomePage
```

All keys added to `env` override `process.env` for the server-side too, and
change the server-side use from run-time to build-time. You can avoid that by
renaming the `env` entry to not match the `process.env` key as shown above.

### Option 4: Define an env var in the Blitz `publicRuntimeConfig` {#option-4-define-an-env-var-in-the-blitz-publicruntimeconfig}

Set at run time; accessible to server and client via a NextJS helper function.
This is only usable on the client side when `GetServerSideProps` is used.

Any keys defined in the `publicRuntimeConfig` section of your Blitz config will
be made available to the server and client. Note that you determine what key will
be used - it can but doesn't have to match the inbound `process.env` key:

```js
// blitz.config.js
module.exports = {
  // env: {},
  publicRuntimeConfig: {
    APP_NAME: process.env.APP_NAME,
    APP_VERSION: process.env.APP_VERSION,
  },
}
```

Example use:

```jsx
// SomePage.tsx
import getConfig from "next/config"
import { GetServerSideProps, Head, BlitzPage } from "blitz"
const { serverRuntimeConfig, publicRuntimeConfig } = getConfig()

type PageProps = {}

export const getServerSideProps: GetServerSideProps<PageProps> = async ({ req, res, ...other }) => {
  return {
    props: {},
  }
}

const EnvVarsPage: BlitzPage<PageProps> = () => {
  return (
    <>
      <Head>
        <title>Env Vars</title>
      </Head>

      <Box as="section" py="4">
        <Box maxW={{ base: "xl", md: "7xl" }} mx="auto" px={{ base: "6", md: "8" }}>
          <Box overflowX="auto">
            <Text>{publicRuntimeConfig.APP_NAME}</Text>
            <Text>{publicRuntimeConfig.APP_VERSION}</Text>
          </Box>
        </Box>
      </Box>
    </>
  )
}
```

Note that to access these values on the client-side, server-side rendering is
required. That can be triggered via `getServerSideProps` or `getInitialProps`.

Without SSR, these values are `undefined` on the client, if the env var was
only provided at run time. Confusingly, if the same env var was provided at
build time (whether or not it was also provided at run time), in the no-SSR
case, the client will see the values from build time. Be careful!

Pages that don't need server-side props for other reasons can use a no-op
invocation of `getServerSideProps` as shown above.

### Option 5: Define an env var in the Blitz `serverRuntimeConfig` {#option-5-define-an-env-var-in-the-blitz-serverruntimeconfig}

Set at run time; accessible to server (not client) via a NextJS helper function.

Any keys defined in the `serverRuntimeConfig` section of your Blitz config will
be made available to the server. Note that you determine what key will
be used - it can but doesn't have to match the inbound `process.env` key:

```js
// blitz.config.js
module.exports = {
  // env: {},
  // publicRuntimeConfig: {},
  serverRuntimeConfig: {
    SUPER_SECRET: process.env.SOME_SECRET,
  },
}
```

Example use:

```jsx
import getConfig from "next/config"
const { serverRuntimeConfig, publicRuntimeConfig } = getConfig()

doSomethingSecretive(serverRuntimeConfig.SUPER_SECRET)
```

## Different Values per Environment {#different-values-per-environment}

In general only one `.env.local` file is needed. However, sometimes you
might want to add some defaults for the `development` or `production`
environment.

Blitz allows you to set defaults in `.env` (all environments),
`.env.development` (development environment), `.env.production`
(production environment), and `.env.test` (test environment). These files
with defaults should be checked into git.

Appending `.local` will override the defaults. Examples: `.env.local`,
`.env.test.local`. These files should **not** be checked into git.

## Using custom environments {#custom-environments}

The three default environments are `production`, `development`, and
`test`. However, sometimes, you need an additional environment, e.g.
`staging`, to store env variables for it in a separate file. You can
provide an app environment name by passing `-e` (`--env`) flag or setting
`APP_ENV` directly. For example:

```
APP_ENV=staging blitz build

blitz prisma generate -e=staging

blitz dev --env staging
```

This will load additional env files: `.env.<APP_NAME>` and
`.env.<APP_NAME>.local`.

If you need to load multiple env files, you can pass all the environments
as comma-separated strings. For example:

```bash
blitz dev --env staging,production
# Loaded .env.staging.local
# Loaded .env.staging
# Loaded .env.production.local
# Loaded .env.production
# Loaded .env.local
# Loaded .env
```
